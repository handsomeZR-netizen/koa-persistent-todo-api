# 实现计划

- [x] 1. 初始化项目并安装依赖





  - 创建 `package.json` 并安装 koa、koa-router、koa-bodyparser、uuid
  - 安装开发依赖：jest、supertest、fast-check
  - 配置 Jest 测试环境
  - _需求：所有_
-

- [x] 2. 实现存储模块 (storage.js)




  - 实现 `loadTodos()` 函数：从 todos.json 读取任务列表
  - 实现 `saveTodos()` 函数：将任务列表写入 todos.json
  - 处理文件不存在、JSON 损坏等错误情况
  - _需求：5.1, 5.2, 5.3, 5.4_

- [x] 2.1 为存储模块编写基于属性的测试


  - **属性 14：服务重启后数据持久化**
  - **验证需求：5.1**
-

- [x] 3. 实现路由和 CRUD 操作




  - 创建 Koa 应用和路由器实例
  - 实现 `GET /api/todos`：获取所有任务
  - 实现 `POST /api/todos`：创建新任务（生成 id、createdAt，设置默认 completed）
  - 实现 `POST /api/todos/:id`：更新任务（支持部分更新）
  - 实现 `DELETE /api/todos/:id`：删除任务
  - 添加输入验证（title 必填）
  - 处理 404 错误（任务不存在）
  - _需求：1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 2.3, 2.4, 2.5, 3.1, 3.2, 3.3, 3.4, 3.5, 4.1, 4.2, 4.3, 4.4, 6.1, 6.3_

- [x] 3.1 为 GET 端点编写基于属性的测试


  - **属性 1：获取所有任务返回完整列表**
  - **验证需求：1.1, 1.3, 1.4**

- [x] 3.2 为 POST 创建端点编写基于属性的测试


  - **属性 2：创建任务生成必需字段**
  - **属性 3：创建任务保留 completed 状态**
  - **属性 4：创建任务的持久化往返**
  - **属性 5：成功创建返回 201 和任务对象**
  - **验证需求：2.1, 2.2, 2.4, 2.5**

- [x] 3.3 为 POST 更新端点编写基于属性的测试


  - **属性 6：更新任务修改指定字段**
  - **属性 7：更新任务的持久化往返**
  - **属性 8：更新不存在的任务返回 404**
  - **属性 9：部分更新保留未修改字段**
  - **验证需求：3.1, 3.2, 3.3, 3.4, 3.5**

- [x] 3.4 为 DELETE 端点编写基于属性的测试


  - **属性 10：删除任务移除存储**
  - **属性 11：删除任务的持久化往返**
  - **属性 12：删除不存在的任务返回 404**
  - **属性 13：成功删除返回 204**
  - **验证需求：4.1, 4.2, 4.3, 4.4**

- [x] 3.5 为输入验证编写基于属性的测试


  - **属性 15：JSON 请求体解析**
  - **属性 16：缺少必需字段被拒绝**
  - **验证需求：6.1, 6.3**

- [x] 4. 创建应用入口 (app.js)





  - 初始化 Koa 应用
  - 注册 koa-bodyparser 中间件
  - 注册路由中间件
  - 添加全局错误处理中间件
  - 启动服务器监听端口 3000
  - _需求：6.1, 6.2, 7.1, 7.2_

- [x] 5. 最终检查点





  - 确保所有测试通过，如有问题请询问用户
